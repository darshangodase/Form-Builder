import{a as h}from"/build/_shared/chunk-TEXLLCYY.js";import{b as y,c as n}from"/build/_shared/chunk-YJPYFN35.js";import"/build/_shared/chunk-YR3RFZAI.js";import"/build/_shared/chunk-J5ZB2QX5.js";import{a as A,d as x,h as d,q as v}from"/build/_shared/chunk-IUDK57FJ.js";import{e as u}from"/build/_shared/chunk-2TWE7TSA.js";var a=u(A(),1);var e=u(v(),1),N="http://localhost:5000/api";function k(){let{user:m}=y(s=>s.auth),[b,f]=(0,a.useState)([]),[w,l]=(0,a.useState)(!0),[p,c]=(0,a.useState)(null),F=x();return(0,a.useEffect)(()=>{(async()=>{if(!m?.id){F("/auth/login"),c("Please log in to view your forms"),l(!1);return}try{l(!0);let r=await fetch(`${N}/forms/user/${m.id}`,{headers:{Accept:"application/json","Content-Type":"application/json"}}),i=await r.json();if(!r.ok)throw new Error(i.message||"Failed to fetch forms");if(!i.success)throw new Error(i.message||"Failed to fetch forms");let I=await Promise.all(i.forms.map(async t=>{try{let o=await fetch(`${N}/forms/${t.formId}/submissions`,{headers:{Accept:"application/json","Content-Type":"application/json"}}),g=await o.json();return!o.ok||!g.success?(console.warn(`Failed to fetch submissions for form ${t.formId}:`,g.message),{...t,submissions:[]}):{...t,submissions:g.submissions||[]}}catch(o){return console.warn(`Error fetching submissions for form ${t.formId}:`,o),{...t,submissions:[]}}}));f(I),c(null)}catch(r){console.error("Error fetching forms:",r),c(r instanceof Error?r.message:"Failed to load forms. Please try again."),f([])}finally{l(!1)}})()},[m?.id]),w?(0,e.jsxs)("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:[(0,e.jsx)(n,{}),(0,e.jsx)("div",{className:"pt-24 px-4 sm:px-6 lg:px-8",children:(0,e.jsx)("div",{className:"max-w-7xl mx-auto",children:(0,e.jsx)("div",{className:"animate-pulse space-y-4",children:[1,2,3].map(s=>(0,e.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:[(0,e.jsx)("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-1/4 mb-4"}),(0,e.jsx)("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-1/2 mb-4"}),(0,e.jsx)("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-3/4"})]},s))})})})]}):p?(0,e.jsxs)("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:[(0,e.jsx)(n,{}),(0,e.jsx)("div",{className:"pt-24 px-4 sm:px-6 lg:px-8",children:(0,e.jsx)("div",{className:"max-w-7xl mx-auto",children:(0,e.jsx)("div",{className:"bg-red-50 dark:bg-red-900/50 border border-red-200 dark:border-red-800 rounded-lg p-4",children:(0,e.jsx)("p",{className:"text-red-600 dark:text-red-400",children:p})})})})]}):(0,e.jsxs)("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:[(0,e.jsx)(n,{}),(0,e.jsx)("div",{className:"pt-24 px-4 sm:px-6 lg:px-8",children:(0,e.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,e.jsxs)("div",{className:"mb-8",children:[(0,e.jsx)("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"My Forms"}),(0,e.jsx)("p",{className:"mt-2 text-sm text-gray-600 dark:text-gray-400",children:"View and manage your forms and their submissions"})]}),b.length===0?(0,e.jsxs)("div",{className:"text-center py-12",children:[(0,e.jsx)("h3",{className:"text-lg font-medium text-gray-900 dark:text-white",children:"No forms yet"}),(0,e.jsx)("p",{className:"mt-2 text-sm text-gray-600 dark:text-gray-400",children:"Get started by creating a new form"}),(0,e.jsx)("div",{className:"mt-6",children:(0,e.jsx)(d,{to:"/builder",className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Create New Form"})})]}):(0,e.jsx)("div",{className:"space-y-4",children:b.map(s=>(0,e.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow overflow-hidden border border-gray-200 dark:border-gray-700",children:(0,e.jsxs)("div",{className:"p-4 flex items-center justify-between",children:[(0,e.jsx)("div",{className:"flex-1 min-w-0",children:(0,e.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,e.jsx)("div",{className:"flex-shrink-0 h-10 w-10 rounded-full bg-blue-100 dark:bg-blue-900 flex items-center justify-center",children:(0,e.jsx)("svg",{className:"h-6 w-6 text-blue-600 dark:text-blue-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,e.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),(0,e.jsxs)("div",{children:[(0,e.jsx)("h3",{className:"text-lg font-medium text-gray-900 dark:text-white truncate",children:s.title}),(0,e.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:s.description})]})]})}),(0,e.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,e.jsxs)("div",{className:"flex flex-col items-end",children:[(0,e.jsxs)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200",children:[s.submissions.length," responses"]}),(0,e.jsxs)("span",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:["Created ",h(new Date(s.createdAt),"MMM d, yyyy")]})]}),(0,e.jsxs)("div",{className:"flex space-x-2",children:[(0,e.jsx)(d,{to:`/form/${s.formId}`,className:"inline-flex items-center px-3 py-1.5 border border-gray-300 dark:border-gray-600 text-sm font-medium rounded-md text-gray-700 dark:text-gray-200 bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700",children:"View Form"}),(0,e.jsx)(d,{to:`/response/${s.formId}`,className:"inline-flex items-center px-3 py-1.5 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 dark:bg-blue-500 dark:hover:bg-blue-600",children:"View Responses"})]})]})]})},s.formId))})]})})]})}export{k as default};
