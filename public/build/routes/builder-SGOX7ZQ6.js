import{a as pe}from"/build/_shared/chunk-HEJKDUNN.js";import{a as dt}from"/build/_shared/chunk-6EOWRYR3.js";import{b as de,c as ze}from"/build/_shared/chunk-YJPYFN35.js";import"/build/_shared/chunk-YR3RFZAI.js";import{C as Be,D as Ve,E as ve,G as He,L as Ke,P as me,a as le,b as P,f as Ie,g as Pe,j as Oe,l as Te,m as ce,n as ue,o as Re,r as Ue,t as qe,u as Ae,v as ge,w as Le,x as Me,y as $e}from"/build/_shared/chunk-J5ZB2QX5.js";import{a as ie,d as Se,g as Ce,l as Ee,q as I}from"/build/_shared/chunk-IUDK57FJ.js";import{e as x}from"/build/_shared/chunk-2TWE7TSA.js";var pt=x(dt(),1);var l=x(ie(),1);var O=x(I(),1),lt=[{type:"text",label:"Text Input",icon:Le,description:"Single line text input",validationType:"text"},{type:"email",label:"Email Input",icon:Me,description:"Email address input with validation",validationType:"email"},{type:"phone",label:"Phone Input",icon:Ve,description:"Phone number input with validation",validationType:"phone"},{type:"textarea",label:"Text Area",icon:ge,description:"Multi-line text input",validationType:"text"},{type:"dropdown",label:"Dropdown",icon:ue,description:"Select from options",defaultOption:"Select your option"},{type:"checkbox",label:"Checkbox",icon:ce,description:"Boolean input"},{type:"date",label:"Date Picker",icon:Oe,description:"Date selection",validationType:"date"}];function ye({onDragStart:e}){return(0,O.jsx)("div",{className:"w-64 bg-white dark:bg-gray-800 border-r border-gray-200 dark:border-gray-700 h-full overflow-y-auto transition-colors duration-200",children:(0,O.jsxs)("div",{className:"p-4",children:[(0,O.jsx)("h2",{className:"text-lg font-semibold text-gray-800 dark:text-gray-100 mb-4",children:"Form Fields"}),(0,O.jsx)("div",{className:"space-y-2",children:lt.map(s=>(0,O.jsx)(P.div,{whileHover:{scale:1.02},whileTap:{scale:.98},children:(0,O.jsx)("div",{className:`p-3 bg-gray-50 dark:bg-gray-700/50 rounded-lg cursor-move \r
                  hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors \r
                  border border-gray-200 dark:border-gray-600`,draggable:!0,onDragStart:m=>e(m,s.type),children:(0,O.jsxs)("div",{className:"flex items-center gap-3",children:[(0,O.jsx)("div",{className:"p-2 bg-white dark:bg-gray-600 rounded-md shadow-sm",children:(0,O.jsx)(s.icon,{className:"w-5 h-5 text-gray-600 dark:text-gray-300"})}),(0,O.jsxs)("div",{children:[(0,O.jsx)("h3",{className:"font-medium text-gray-800 dark:text-gray-100",children:s.label}),(0,O.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:s.description})]})]})})},s.type))})]})})}var ae=x(ie(),1);var T=x(ie(),1);var r=x(I(),1);function fe({field:e,onUpdate:s,onDelete:m,onMove:y,onDuplicate:u,isFirst:V,isLast:p}){let[f,k]=(0,T.useState)(!1),[M,v]=(0,T.useState)(e.label),[C,E]=(0,T.useState)(e.placeholder||""),[$,F]=(0,T.useState)(e.required||!1),[B,W]=(0,T.useState)(e.options||[]),[U,z]=(0,T.useState)(e.checkboxOptions||[]),[Z,Q]=(0,T.useState)(""),[_,ee]=(0,T.useState)(""),X=(0,T.useRef)(null);(0,T.useEffect)(()=>{v(e.label),E(e.placeholder||""),F(e.required||!1),W(e.options||[]),z(e.checkboxOptions||[])},[e]),(0,T.useEffect)(()=>{f&&X.current&&X.current.focus()},[f]);let S="w-64 px-3 py-1.5 bg-white dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent shadow-sm text-gray-900 dark:text-white placeholder-gray-400 dark:placeholder-gray-500 disabled:text-gray-500 dark:disabled:text-gray-400 disabled:bg-gray-50 dark:disabled:bg-gray-800",G=()=>{s(e.id,{label:M,placeholder:e.type==="dropdown"?void 0:C,required:$,options:e.type==="dropdown"?B:void 0,checkboxOptions:e.type==="checkbox"?U:void 0}),k(!1)},q=()=>{v(e.label),E(e.placeholder||""),F(e.required||!1),W(e.options||[]),z(e.checkboxOptions||[]),k(!1)},Y=i=>{i.key==="Enter"&&i.ctrlKey?G():i.key==="Escape"&&q()},a=()=>{Z.trim()&&(W([...B,Z.trim()]),Q(""))},g=i=>{W(B.filter((w,L)=>L!==i))},h=()=>{_.trim()&&(z([...U,_.trim()]),ee(""))},H=i=>{z(U.filter((w,L)=>L!==i))},A=()=>{switch(e.type){case"text":return(0,r.jsx)("input",{type:"text",className:S,placeholder:e.placeholder||"Enter text...",disabled:!0});case"email":return(0,r.jsx)("input",{type:"email",className:S,placeholder:e.placeholder||"Enter email address...",disabled:!0});case"phone":return(0,r.jsx)("input",{type:"tel",className:S,placeholder:e.placeholder||"Enter 10-digit phone number...",disabled:!0});case"textarea":return(0,r.jsx)("textarea",{className:S,rows:3,placeholder:e.placeholder||"Enter text...",disabled:!0});case"dropdown":return(0,r.jsxs)("select",{className:`${S} bg-white dark:bg-gray-700`,disabled:!0,children:[(0,r.jsx)("option",{value:"",disabled:!0,selected:!0,className:"text-gray-500 dark:text-gray-400",children:"Select your option"}),e.options&&e.options.length>0?e.options.map((i,w)=>(0,r.jsx)("option",{value:i.toLowerCase().replace(/\s+/g,"-"),className:"text-gray-900 dark:text-white",children:i},w)):(0,r.jsx)("option",{value:"",disabled:!0,className:"text-gray-500 dark:text-gray-400",children:"No options added"})]});case"checkbox":return(0,r.jsx)("div",{className:"space-y-2",children:e.checkboxOptions&&e.checkboxOptions.length>0?e.checkboxOptions.map((i,w)=>(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("input",{type:"checkbox",className:"w-4 h-4 appearance-none border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 checked:bg-blue-600 checked:border-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-0 disabled:opacity-50 disabled:cursor-not-allowed checked:bg-[url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%2020%2020%22%20fill%3D%22%23fff%22%3E%3Cpath%20fill-rule%3D%22evenodd%22%20d%3D%22M16.707%205.293a1%201%200%20010%201.414l-8%208a1%201%200%2001-1.414%200l-4-4a1%201%200%20011.414-1.414L8%2012.586l7.293-7.293a1%201%200%20011.414%200z%22%20clip-rule%3D%22evenodd%22%2F%3E%3C%2Fsvg%3E')] checked:bg-center checked:bg-no-repeat",disabled:!0}),(0,r.jsx)("label",{className:"ml-2 text-gray-700 dark:text-gray-300",children:i})]},w)):(0,r.jsx)("div",{className:"text-gray-500 dark:text-gray-400 italic",children:"No checkbox options added"})});case"date":return(0,r.jsx)("input",{type:"date",className:S,disabled:!0});default:return null}},ne=()=>null;return(0,r.jsxs)(P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 group relative",children:[(0,r.jsx)("div",{className:"absolute -right-2 -top-2 opacity-0 group-hover:opacity-100 transition-opacity",children:(0,r.jsxs)("div",{className:"flex gap-1 bg-white dark:bg-gray-700 rounded-lg shadow-lg border border-gray-200 dark:border-gray-600 p-1",children:[(0,r.jsx)("button",{onClick:()=>k(!0),className:"p-1 hover:bg-gray-100 dark:hover:bg-gray-600 rounded-md transition-colors",title:"Edit field",children:(0,r.jsx)(Be,{className:"w-4 h-4 text-gray-600 dark:text-gray-300"})}),(0,r.jsx)("button",{onClick:()=>u(e.id),className:"p-1 hover:bg-gray-100 dark:hover:bg-gray-600 rounded-md transition-colors",title:"Duplicate field",children:(0,r.jsx)(ge,{className:"w-4 h-4 text-gray-600 dark:text-gray-300"})}),(0,r.jsx)("button",{onClick:()=>m(e.id),className:"p-1 hover:bg-red-50 dark:hover:bg-red-900/30 rounded-md transition-colors",title:"Delete field",children:(0,r.jsx)(Ke,{className:"w-4 h-4 text-red-600 dark:text-red-400"})}),!V&&(0,r.jsx)("button",{onClick:()=>y(e.id,"up"),className:"p-1 hover:bg-gray-100 dark:hover:bg-gray-600 rounded-md transition-colors",title:"Move up",children:(0,r.jsx)(Re,{className:"w-4 h-4 text-gray-600 dark:text-gray-300"})}),!p&&(0,r.jsx)("button",{onClick:()=>y(e.id,"down"),className:"p-1 hover:bg-gray-100 dark:hover:bg-gray-600 rounded-md transition-colors",title:"Move down",children:(0,r.jsx)(ue,{className:"w-4 h-4 text-gray-600 dark:text-gray-300"})})]})}),f?(0,r.jsxs)("div",{className:"space-y-3 max-w-md",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("label",{className:"w-32 text-sm font-medium text-gray-700 dark:text-gray-300",children:"Field Label:"}),(0,r.jsx)("input",{type:"text",value:M,onChange:i=>v(i.target.value),onKeyDown:Y,className:S,placeholder:"Enter field label",ref:X})]}),e.type==="dropdown"?(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Options:"}),(0,r.jsxs)("div",{className:"space-y-2",children:[B.map((i,w)=>(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("input",{type:"text",value:i,onChange:L=>{let K=[...B];K[w]=L.target.value,W(K)},className:S,placeholder:"Option text"}),(0,r.jsx)("button",{onClick:()=>g(w),className:"p-1 hover:bg-red-50 dark:hover:bg-red-900/30 rounded-md transition-colors",title:"Remove option",children:(0,r.jsx)(me,{className:"w-4 h-4 text-red-600 dark:text-red-400"})})]},w)),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("input",{type:"text",value:Z,onChange:i=>Q(i.target.value),onKeyDown:i=>{i.key==="Enter"&&(i.preventDefault(),a())},className:S,placeholder:"Add new option"}),(0,r.jsx)("button",{onClick:a,className:"p-1 hover:bg-blue-50 dark:hover:bg-blue-900/30 rounded-md transition-colors",title:"Add option",children:(0,r.jsx)(ve,{className:"w-4 h-4 text-blue-600 dark:text-blue-400"})})]})]})]}):e.type==="checkbox"?(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Checkbox Options:"}),(0,r.jsxs)("div",{className:"space-y-2",children:[U.map((i,w)=>(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("input",{type:"text",value:i,onChange:L=>{let K=[...U];K[w]=L.target.value,z(K)},className:S,placeholder:"Checkbox label"}),(0,r.jsx)("button",{onClick:()=>H(w),className:"p-1 hover:bg-red-50 dark:hover:bg-red-900/30 rounded-md transition-colors",title:"Remove option",children:(0,r.jsx)(me,{className:"w-4 h-4 text-red-600 dark:text-red-400"})})]},w)),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("input",{type:"text",value:_,onChange:i=>ee(i.target.value),onKeyDown:i=>{i.key==="Enter"&&(i.preventDefault(),h())},className:S,placeholder:"Add new checkbox option"}),(0,r.jsx)("button",{onClick:h,className:"p-1 hover:bg-blue-50 dark:hover:bg-blue-900/30 rounded-md transition-colors",title:"Add option",children:(0,r.jsx)(ve,{className:"w-4 h-4 text-blue-600 dark:text-blue-400"})})]})]})]}):(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("label",{className:"w-32 text-sm font-medium text-gray-700 dark:text-gray-300",children:"Placeholder:"}),(0,r.jsx)("input",{type:"text",value:C,onChange:i=>E(i.target.value),onKeyDown:Y,className:S,placeholder:"Enter placeholder text"})]}),(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("label",{className:"w-32 text-sm font-medium text-gray-700 dark:text-gray-300",children:"Required:"}),(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("input",{type:"checkbox",id:`required-${e.id}`,checked:$,onChange:i=>F(i.target.checked),className:"w-4 h-4 appearance-none border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 checked:bg-blue-600 checked:border-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-0 checked:bg-[url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%2020%2020%22%20fill%3D%22%23fff%22%3E%3Cpath%20fill-rule%3D%22evenodd%22%20d%3D%22M16.707%205.293a1%201%200%20010%201.414l-8%208a1%201%200%2001-1.414%200l-4-4a1%201%200%20011.414-1.414L8%2012.586l7.293-7.293a1%201%200%20011.414%200z%22%20clip-rule%3D%22evenodd%22%2F%3E%3C%2Fsvg%3E')] checked:bg-center checked:bg-no-repeat"}),(0,r.jsx)("label",{htmlFor:`required-${e.id}`,className:"ml-2 text-sm text-gray-700 dark:text-gray-300",children:"Make this field required"})]})]}),(0,r.jsx)("div",{className:"flex justify-between items-center pt-2",children:(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsxs)("button",{onClick:q,className:"px-3 py-1.5 text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors flex items-center gap-1",children:[(0,r.jsx)(me,{className:"w-4 h-4"}),"Cancel"]}),(0,r.jsxs)("button",{onClick:G,className:"px-3 py-1.5 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 dark:bg-blue-500 dark:hover:bg-blue-600 rounded-md transition-colors flex items-center gap-1",children:[(0,r.jsx)(ce,{className:"w-4 h-4"}),"Save"]})]})})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[e.label,e.required&&(0,r.jsx)("span",{className:"text-red-500 dark:text-red-400 ml-1",children:"*"})]}),A()]})]})}var b=x(I(),1);function he({fields:e,onDrop:s,onUpdate:m,onDelete:y,onMove:u,onDuplicate:V,onDragOver:p,formName:f="Untitled Form",formDescription:k="",onFormDetailsUpdate:M}){let[v,C]=(0,ae.useState)(!1),[E,$]=(0,ae.useState)(0),[F,B]=(0,ae.useState)(null),[W,U]=(0,ae.useState)(null),z={submitButtonText:"Submit",successMessage:"Thank you for your submission!"},Z=a=>{a.preventDefault(),C(!0),p?.(a)},Q=a=>{a.preventDefault(),$(g=>g+1),C(!0)},_=a=>{a.preventDefault(),$(g=>g-1),E<=1&&C(!1)},ee=a=>{a.preventDefault(),$(0),C(!1);let g=a.dataTransfer.getData("fieldType");g&&s(g)},X=(a,g)=>{a.stopPropagation(),B(g),a.dataTransfer.setData("fieldId",g),a.dataTransfer.effectAllowed="move"},S=(a,g)=>{a.preventDefault(),a.stopPropagation(),F!==g&&U(g)},G=a=>{a.preventDefault(),a.stopPropagation(),U(null)},q=(a,g)=>{if(a.preventDefault(),a.stopPropagation(),!F||F===g){B(null),U(null);return}let h=e.findIndex(A=>A.id===F),H=e.findIndex(A=>A.id===g);if(!(h===-1||H===-1)){if(h<H)for(let A=h;A<H;A++)u(F,"down");else for(let A=h;A>H;A--)u(F,"up");B(null),U(null)}},Y=()=>{B(null),U(null)};return(0,b.jsxs)("div",{className:"flex h-full",children:[(0,b.jsx)("div",{className:`flex-1 min-h-full ${v?"bg-blue-50 dark:bg-blue-900/20":"bg-gray-100 dark:bg-gray-800"} transition-colors overflow-auto`,onDragOver:Z,onDragEnter:Q,onDragLeave:_,onDrop:ee,children:(0,b.jsx)("div",{className:"max-w-2xl mx-auto p-6",children:(0,b.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-6 border border-gray-200 dark:border-gray-700",children:[(0,b.jsxs)("div",{className:"mb-8 text-center",children:[(0,b.jsx)("input",{type:"text",value:f,onChange:a=>M?.({name:a.target.value}),className:"text-2xl font-semibold text-gray-900 dark:text-white mb-2 text-center w-full bg-transparent border-none focus:outline-none focus:ring-2 focus:ring-blue-500 rounded px-2 py-1",placeholder:"Untitled Form"}),(0,b.jsx)("input",{type:"text",value:k,onChange:a=>M?.({description:a.target.value}),className:"text-gray-600 dark:text-gray-300 max-w-lg mx-auto w-full bg-transparent border-none focus:outline-none focus:ring-2 focus:ring-blue-500 rounded px-2 py-1 text-center",placeholder:"Add a description for your form"})]}),e.length===0?(0,b.jsx)(P.div,{initial:{opacity:0},animate:{opacity:1},className:"text-center py-12",children:(0,b.jsxs)("div",{className:`border-2 border-dashed rounded-lg p-8 transition-colors duration-200 ${v?"border-blue-400 dark:border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-gray-300 dark:border-gray-600"}`,children:[(0,b.jsx)("p",{className:`text-lg transition-colors duration-200 ${v?"text-blue-600 dark:text-blue-400":"text-gray-500 dark:text-gray-400"}`,children:v?"Drop to add field":"Drag and drop form fields here to start building your form"}),(0,b.jsx)("p",{className:"text-sm text-gray-400 dark:text-gray-500 mt-2",children:"Available fields: Text Input, Text Area, Dropdown, Checkbox, Date Picker, Email Input, Phone Input"})]})}):(0,b.jsx)(le,{children:(0,b.jsx)("div",{className:"space-y-6",children:e.map((a,g)=>(0,b.jsx)("div",{draggable:!0,onDragStart:h=>X(h,a.id),onDragOver:h=>S(h,a.id),onDragLeave:G,onDrop:h=>q(h,a.id),onDragEnd:Y,className:`relative ${W===a.id?"border-2 border-blue-500 dark:border-blue-400":""}`,children:(0,b.jsx)(fe,{field:a,onUpdate:m,onDelete:y,onMove:u,onDuplicate:V,isFirst:g===0,isLast:g===e.length-1})},a.id))})})]})})}),(0,b.jsxs)("div",{className:"w-1/2 border-l border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 overflow-auto",children:[(0,b.jsxs)("div",{className:"sticky top-0 bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 p-4 z-10 text-center",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold text-gray-800 dark:text-gray-100",children:"Live Preview"}),(0,b.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"See how your form will look to users"})]}),(0,b.jsx)("div",{className:"p-6 flex justify-center",children:(0,b.jsx)("div",{className:"w-full max-w-2xl",children:(0,b.jsx)(pe,{fields:e,settings:z,formName:f,formDescription:k,onSubmit:async a=>(console.log("Preview form submitted:",a),Promise.resolve()),onValidationError:a=>console.log("Preview validation errors:",a)})})})]})]})}var D=[];for(let e=0;e<256;++e)D.push((e+256).toString(16).slice(1));function Je(e,s=0){return(D[e[s+0]]+D[e[s+1]]+D[e[s+2]]+D[e[s+3]]+"-"+D[e[s+4]]+D[e[s+5]]+"-"+D[e[s+6]]+D[e[s+7]]+"-"+D[e[s+8]]+D[e[s+9]]+"-"+D[e[s+10]]+D[e[s+11]]+D[e[s+12]]+D[e[s+13]]+D[e[s+14]]+D[e[s+15]]).toLowerCase()}var xe,ct=new Uint8Array(16);function ke(){if(!xe){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");xe=crypto.getRandomValues.bind(crypto)}return xe(ct)}var ut=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),we={randomUUID:ut};function gt(e,s,m){if(we.randomUUID&&!s&&!e)return we.randomUUID();e=e||{};let y=e.random??e.rng?.()??ke();if(y.length<16)throw new Error("Random bytes length must be >= 16");if(y[6]=y[6]&15|64,y[8]=y[8]&63|128,s){if(m=m||0,m<0||m+16>s.length)throw new RangeError(`UUID byte range ${m}:${m+15} is out of buffer bounds`);for(let u=0;u<16;++u)s[m+u]=y[u];return s}return Je(y)}var re=gt;var c=x(I(),1);function Ne({currentMode:e,onModeChange:s,isPreviewMode:m,onPreviewToggle:y,totalFields:u=0,completedFields:V=0,canUndo:p,canRedo:f,onUndo:k,onRedo:M,onShare:v}){let C=u>0?V/u*100:0;return(0,c.jsx)("div",{className:"flex flex-col bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700",children:(0,c.jsxs)("div",{className:"flex items-center gap-2 px-4 py-2",children:[(0,c.jsxs)("div",{className:"flex items-center gap-1 mr-2",children:[(0,c.jsx)(P.button,{onClick:k,whileHover:{scale:1.02},whileTap:{scale:.98},disabled:!p,className:`p-2 rounded-lg transition-all duration-200 ${p?"text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700":"text-gray-400 dark:text-gray-600 cursor-not-allowed"}`,title:"Undo (Ctrl+Z)",children:(0,c.jsx)(Ie,{className:"w-5 h-5"})}),(0,c.jsx)(P.button,{onClick:M,whileHover:{scale:1.02},whileTap:{scale:.98},disabled:!f,className:`p-2 rounded-lg transition-all duration-200 ${f?"text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700":"text-gray-400 dark:text-gray-600 cursor-not-allowed"}`,title:"Redo (Ctrl+Y or Ctrl+Shift+Z)",children:(0,c.jsx)(Pe,{className:"w-5 h-5"})})]}),(0,c.jsxs)(P.button,{onClick:y,whileHover:{scale:1.02},whileTap:{scale:.98},className:`relative px-4 py-2 rounded-lg transition-all duration-200 flex items-center space-x-2 font-medium ${m?"bg-blue-500 text-white shadow-lg shadow-blue-500/20 hover:bg-blue-600":"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-200 hover:bg-gray-200 dark:hover:bg-gray-600"}`,title:m?"Exit Preview":"Preview Form",children:[(0,c.jsx)($e,{className:`w-5 h-5 transition-transform duration-200 ${m?"rotate-12":""}`}),(0,c.jsx)("span",{children:m?"Exit Preview":"Preview"})]}),m&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)("div",{className:"flex items-center gap-1 ml-2 border-l border-gray-200 dark:border-gray-600 pl-2",children:[(0,c.jsx)("button",{onClick:()=>s("desktop"),className:`p-1.5 rounded-md transition-colors ${e==="desktop"?"bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300":"text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"}`,title:"Desktop View",children:(0,c.jsx)(Ue,{className:"w-5 h-5"})}),(0,c.jsx)("button",{onClick:()=>s("tablet"),className:`p-1.5 rounded-md transition-colors ${e==="tablet"?"bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300":"text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"}`,title:"Tablet View",children:(0,c.jsx)(Ae,{className:"w-5 h-5"})}),(0,c.jsx)("button",{onClick:()=>s("mobile"),className:`p-1.5 rounded-md transition-colors ${e==="mobile"?"bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300":"text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"}`,title:"Mobile View",children:(0,c.jsx)(qe,{className:"w-5 h-5"})})]}),m&&u>0&&(0,c.jsxs)("div",{className:"ml-4 flex items-center gap-2 border-l border-gray-200 dark:border-gray-600 pl-4",children:[(0,c.jsx)("div",{className:"w-32 h-2 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden",children:(0,c.jsx)("div",{className:"h-full bg-blue-600 dark:bg-blue-500 transition-all duration-300 ease-in-out",style:{width:`${C}%`}})}),(0,c.jsxs)("span",{className:"text-sm text-gray-600 dark:text-gray-300",children:[V," of ",u," fields completed"]})]})]}),(0,c.jsx)("button",{onClick:v,className:"p-2 text-gray-600 hover:text-gray-900 dark:text-gray-400 dark:hover:text-white rounded-md hover:bg-gray-100 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-500",title:"Share form",children:(0,c.jsx)(He,{className:"h-5 w-5"})})]})})}var R=x(I(),1);function De({isVisible:e,isSaving:s}){return(0,R.jsx)(le,{children:e&&(0,R.jsx)(P.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:10},className:"fixed bottom-4 right-4 z-50",children:(0,R.jsx)(P.div,{className:`flex items-center gap-2 px-4 py-2 rounded-lg shadow-lg ${s?"bg-blue-500 text-white":"bg-green-500 text-white"}`,children:s?(0,R.jsxs)(R.Fragment,{children:[(0,R.jsx)(P.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full"}),(0,R.jsx)("span",{children:"Saving..."})]}):(0,R.jsxs)(R.Fragment,{children:[(0,R.jsx)(Te,{className:"w-5 h-5"}),(0,R.jsx)("span",{children:"All changes saved"})]})})})})}var d=x(I(),1),je={submitButtonText:"Submit",successMessage:"Thank you for your submission!",title:"",description:""},mt=e=>({text:"Text Input",textarea:"Text Area",dropdown:"Dropdown",checkbox:"Checkbox",date:"Date Picker",email:"Email Address",phone:"Phone Number",number:"Number Input"})[e]||"Field";function Fe({initialTemplate:e,templateId:s}){let{user:m}=de(t=>t.auth),y=()=>{let t=Date.now(),o=re();return`${t}-${o}`},[u]=(0,l.useState)(()=>y()),V=(t=[])=>t.map(o=>({...o,id:re(),label:o.label})),[p,f]=(0,l.useState)(()=>V(e?.fields)),[k,M]=(0,l.useState)(()=>({...e?.settings||je,title:e?.settings?.title||"Untitled Form",description:e?.settings?.description||""})),[v,C]=(0,l.useState)(()=>e?.settings?.title||"Untitled Form"),[E,$]=(0,l.useState)(e?.settings?.description||""),[F,B]=(0,l.useState)(!1),[W,U]=(0,l.useState)([]),[z,Z]=(0,l.useState)("desktop"),[Q,_]=(0,l.useState)(new Set),[ee,X]=(0,l.useState)(!1),[S,G]=(0,l.useState)(!1),[q,Y]=(0,l.useState)([{fields:e?.fields||[],settings:e?.settings||je,formName:e?.settings?.title||"Untitled Form",formDescription:e?.settings?.description||""}]),[a,g]=(0,l.useState)(0),h=(0,l.useRef)(!1),H=`form-builder-${s||"new-form"}`,[A,ne]=(0,l.useState)(!1),[i,w]=(0,l.useState)(!1),L=(0,l.useRef)();(0,l.useEffect)(()=>{(()=>{try{let o=localStorage.getItem(H);if(o){let n=JSON.parse(o);(!e||n.lastSaved>Date.now()-864e5)&&(f(n.fields),M(n.settings),C(n.formName),$(n.formDescription),Y(n.history),g(n.currentHistoryIndex))}}catch(o){console.error("Error loading saved state:",o)}})()},[H,e]);let K=(0,l.useCallback)(()=>{try{ne(!0),w(!0);let t={fields:p,settings:k,formName:v,formDescription:E,history:q,currentHistoryIndex:a,lastSaved:Date.now()};localStorage.setItem(H,JSON.stringify(t)),L.current&&clearTimeout(L.current),L.current=setTimeout(()=>{ne(!1),setTimeout(()=>{w(!1)},1e3)},500)}catch(t){console.error("Error saving state:",t),ne(!1),w(!1)}},[p,k,v,E,q,a,H]);(0,l.useEffect)(()=>()=>{L.current&&clearTimeout(L.current)},[]),(0,l.useEffect)(()=>{K()},[K]),(0,l.useEffect)(()=>{let t=o=>{K()};return window.addEventListener("beforeunload",t),()=>{window.removeEventListener("beforeunload",t),K()}},[K]);let te=(0,l.useCallback)(t=>{if(h.current)return;let o={fields:p,settings:k,formName:v,formDescription:E,...t};Y(n=>{let N=n.slice(0,a+1);return N.push(o),N}),g(n=>n+1)},[p,k,v,E,a]),be=(0,l.useCallback)(()=>{if(a>0){h.current=!0;let t=q[a-1];f(t.fields),M(t.settings),C(t.formName),$(t.formDescription),g(o=>o-1),setTimeout(()=>{h.current=!1},0)}},[a,q]),se=(0,l.useCallback)(()=>{if(a<q.length-1){h.current=!0;let t=q[a+1];f(t.fields),M(t.settings),C(t.formName),$(t.formDescription),g(o=>o+1),setTimeout(()=>{h.current=!1},0)}},[a,q]);(0,l.useEffect)(()=>{let t=o=>{(o.ctrlKey||o.metaKey)&&o.key==="z"?(o.preventDefault(),o.shiftKey?se():be()):(o.ctrlKey||o.metaKey)&&o.key==="y"&&(o.preventDefault(),se())};return window.addEventListener("keydown",t),()=>window.removeEventListener("keydown",t)},[be,se]),(0,l.useEffect)(()=>{if(e){let t={fields:V(e.fields),settings:{...e.settings,title:e.settings.title||"Untitled Form"},formName:e.settings.title||"Untitled Form",formDescription:e.settings.description||""};Y([t]),g(0),f(t.fields),M(t.settings),C(t.formName),$(t.formDescription)}},[e]);let Ye=(t,o)=>{if(!p.find(J=>J.id===t))return;let N=o!=null&&o!=="";_(J=>{let j=new Set(J);return N?j.add(t):j.delete(t),j})},Ze=(t,o)=>{t.dataTransfer.setData("fieldType",o);let n=t.currentTarget.cloneNode(!0);n.style.position="absolute",n.style.top="-1000px",document.body.appendChild(n),t.dataTransfer.setDragImage(n,0,0),requestAnimationFrame(()=>{document.body.removeChild(n)})},_e=t=>{let o={id:re(),type:t,label:mt(t),placeholder:t==="dropdown"?void 0:`Enter ${t}...`,options:t==="dropdown"?[]:void 0,checkboxOptions:t==="checkbox"?[]:void 0},n=[...p,o];f(n),te({fields:n})},vt=t=>{t.preventDefault(),t.dataTransfer.dropEffect="copy"},Ge=(t,o)=>{let n=p.map(N=>N.id===t?{...N,...o}:N);f(n),te({fields:n})},Qe=t=>{let o=p.filter(n=>n.id!==t);f(o),te({fields:o})},et=(t,o)=>{let n=[...p],N=n.findIndex(j=>j.id===t);if(o==="up"&&N===0||o==="down"&&N===n.length-1)return;let J=o==="up"?N-1:N+1;[n[N],n[J]]=[n[J],n[N]],f(n),te({fields:n})},tt=t=>{let o=p.find(j=>j.id===t);if(!o)return;let n={...o,id:re(),label:`${o.label} (Copy)`},N=p.findIndex(j=>j.id===t),J=[...p];J.splice(N+1,0,n),f(J),te({fields:J})},rt=async t=>{console.log("Form submitted:",t),await new Promise(o=>setTimeout(o,1e3))},ot=t=>{U(t)},at=()=>{switch(z){case"mobile":return"max-w-sm";case"tablet":return"max-w-2xl";case"desktop":default:return"max-w-4xl"}},nt=t=>{let o=t.name!==void 0?t.name:v,n=t.description!==void 0?t.description:E;C(o),$(n),te({formName:o,formDescription:n})},st=async()=>{try{let t={formName:v,formDescription:E,fields:p,settings:k,createdAt:Date.now(),createdBy:m?.id||"anonymous",formId:u,templateId:s||"custom"};localStorage.setItem(`form-data-${u}`,JSON.stringify(t));let o=await fetch("/api/forms",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:v,description:E,fields:p.map(n=>({id:n.id,type:n.type,label:n.label,required:n.required,placeholder:n.placeholder,options:n.options,checkboxOptions:n.checkboxOptions})),settings:{submitButtonText:k.submitButtonText,successMessage:k.successMessage},isPublic:!0,formId:u,userId:m?.id||"anonymous"})});if(!o.ok){let n=await o.json();throw console.log(n),new Error(n.message||"Failed to save form to database")}X(!0)}catch(t){console.error("Error saving form data:",t),alert("Failed to save form. Please try again.")}},it=async()=>{try{let t=`${window.location.origin}/form/${u}`;await navigator.clipboard.writeText(t),G(!0),setTimeout(()=>G(!1),2e3),console.log("Share link copied:",t)}catch(t){console.error("Failed to copy link:",t)}};return(0,d.jsxs)("div",{className:"flex flex-col h-screen bg-gray-50 dark:bg-gray-900 transition-colors duration-200",children:[(0,d.jsx)(Ne,{currentMode:z,onModeChange:Z,isPreviewMode:F,onPreviewToggle:()=>B(!F),totalFields:p.length,completedFields:Q.size,canUndo:a>0,canRedo:a<q.length-1,onUndo:be,onRedo:se,onShare:st}),(0,d.jsxs)("div",{className:"flex flex-1 overflow-hidden bg-gray-50 dark:bg-gray-900",children:[!F&&(0,d.jsx)(ye,{onDragStart:Ze}),(0,d.jsx)("div",{className:`flex-1 overflow-auto p-4 ${F?"flex justify-center":""}`,children:F?(0,d.jsx)("div",{className:`w-full ${at()} mx-auto transition-all duration-300`,children:(0,d.jsx)(pe,{fields:p,settings:k,formName:v,formDescription:E,onSubmit:rt,onValidationError:ot,onFieldChange:Ye})}):(0,d.jsx)(he,{fields:p,onDrop:_e,onUpdate:Ge,onDelete:Qe,onMove:et,onDuplicate:tt,formName:v,formDescription:E,onFormDetailsUpdate:nt})})]}),ee&&(0,d.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,d.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 max-w-md w-full",children:[(0,d.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,d.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Share Your Form"}),(0,d.jsxs)("button",{onClick:()=>X(!1),className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200",children:[(0,d.jsx)("span",{className:"sr-only",children:"Close"}),(0,d.jsx)("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,d.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})]})]}),(0,d.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-300 mb-4",children:"Share this link with others to let them fill out your form."}),(0,d.jsxs)("div",{className:"flex items-center space-x-2 mb-4",children:[(0,d.jsx)("input",{type:"text",readOnly:!0,value:`${window.location.origin}/form/${u}`,className:"flex-1 px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-gray-50 dark:bg-gray-700 text-gray-900 dark:text-white text-sm"}),(0,d.jsx)("button",{onClick:it,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors",children:S?"Copied!":"Copy"})]}),(0,d.jsxs)("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:[(0,d.jsx)("p",{children:"Anyone with this link can:"}),(0,d.jsxs)("ul",{className:"list-disc list-inside mt-2 space-y-1",children:[(0,d.jsx)("li",{children:"View and fill out your form"}),(0,d.jsx)("li",{children:"Submit responses"})]})]}),(0,d.jsxs)("div",{className:"mt-4 pt-4 border-t border-gray-200 dark:border-gray-700",children:[(0,d.jsxs)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Form ID: ",u]}),(0,d.jsxs)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:["Created: ",new Date(parseInt(u.split("-")[0])).toLocaleString()]}),(0,d.jsxs)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:["Template: ",s||"Custom Form"]}),(0,d.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"This is a unique form with its own submission link"})]})]})}),(0,d.jsx)(De,{isVisible:i,isSaving:A})]})}var We=x(ie(),1),oe=x(I(),1),bt=()=>[{title:"Form Builder"},{name:"description",content:"Build beautiful forms with our drag-and-drop form builder"}];function Xe(){let{template:e}=Ee(),[s]=Ce(),m=s.get("template"),y=Se(),{isAuthenticated:u}=de(V=>V.auth);return(0,We.useEffect)(()=>{u||y("/auth/login")},[u,y]),u?(0,oe.jsxs)("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 transition-colors duration-200",children:[(0,oe.jsx)(ze,{}),(0,oe.jsx)("div",{className:"pt-16",children:(0,oe.jsx)(Fe,{initialTemplate:e,templateId:m})})]}):null}export{Xe as default,bt as meta};
